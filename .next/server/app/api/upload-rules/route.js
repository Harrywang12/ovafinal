"use strict";(()=>{var e={};e.id=680,e.ids=[680],e.modules={517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},336:(e,r,t)=>{t.r(r),t.d(r,{headerHooks:()=>g,originalPathname:()=>y,patchFetch:()=>A,requestAsyncStorage:()=>h,routeModule:()=>m,serverHooks:()=>S,staticGenerationAsyncStorage:()=>v,staticGenerationBailout:()=>E});var a={};t.r(a),t.d(a,{POST:()=>f,runtime:()=>c});var n=t(5419),o=t(9108),s=t(9678),i=t(8070),u=t(8234),l=t(5752);let p=require("crypto");var d=t.n(p);let c="nodejs";async function f(e){let r;(0,l.V1)(["SUPABASE_URL","SUPABASE_SERVICE_KEY"]);let t=(0,u.b)();if(!(e.headers.get("content-type")||"").includes("multipart/form-data"))return i.Z.json({error:"Invalid Content-Type. Expected multipart/form-data for file upload.",hint:"Use FormData or curl with -F flag"},{status:415});try{r=await e.formData()}catch(e){return i.Z.json({error:"Failed to parse form data"},{status:400})}let a=r.get("file");if(!a)return i.Z.json({error:"No file provided"},{status:400});let n=await a.arrayBuffer(),o=Buffer.from(n),s=`rules/${d().randomUUID()}-${a.name}`,{data:p,error:c}=await t.storage.from("rules").upload(s,o,{contentType:a.type,upsert:!0});return c?i.Z.json({error:c.message},{status:500}):i.Z.json({path:p?.path,bucket:"rules"})}let m=new n.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/upload-rules/route",pathname:"/api/upload-rules",filename:"route",bundlePath:"app/api/upload-rules/route"},resolvedPagePath:"/Users/harrisonwang/ovafinal/app/api/upload-rules/route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:h,staticGenerationAsyncStorage:v,serverHooks:S,headerHooks:g,staticGenerationBailout:E}=m,y="/api/upload-rules/route";function A(){return(0,s.patchFetch)({serverHooks:S,staticGenerationAsyncStorage:v})}},8234:(e,r,t)=>{t.d(r,{b:()=>s});var a=t(7493);let n="https://uglzhvquiarxyahsnesj.supabase.co",o=process.env.SUPABASE_SERVICE_KEY,s=()=>{if(!n||!o)throw Error("Supabase environment variables missing (SUPABASE_URL, SUPABASE_SERVICE_KEY).");return(0,a.eI)(n,o,{global:{headers:{"x-client-info":"volleyball-ref-training"}},auth:{autoRefreshToken:!1,detectSessionInUrl:!1,persistSession:!1}})}},5752:(e,r,t)=>{function a(e){switch(e){case"easy":return 3;case"medium":return 4;case"hard":return 5;default:return 6}}function n(e){return e.map((e,r)=>`Rule Snippet ${r+1}${e.similarity?` (sim ${e.similarity.toFixed(2)})`:""}:
${e.chunk}`).join("\n\n")}function o(e){let r=e.filter(e=>!process.env[e]);if(r.length)throw Error(`Missing environment variables: ${r.join(", ")}`)}t.d(r,{V1:()=>o,aZ:()=>n,uF:()=>a})}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[638,164],()=>t(336));module.exports=a})();