"use strict";(()=>{var e={};e.id=415,e.ids=[415],e.modules={517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},7147:e=>{e.exports=require("fs")},3685:e=>{e.exports=require("http")},5687:e=>{e.exports=require("https")},7561:e=>{e.exports=require("node:fs")},4492:e=>{e.exports=require("node:stream")},2477:e=>{e.exports=require("node:stream/web")},1017:e=>{e.exports=require("path")},5477:e=>{e.exports=require("punycode")},2781:e=>{e.exports=require("stream")},7310:e=>{e.exports=require("url")},3837:e=>{e.exports=require("util")},1267:e=>{e.exports=require("worker_threads")},9796:e=>{e.exports=require("zlib")},4045:(e,r,t)=>{t.r(r),t.d(r,{headerHooks:()=>f,originalPathname:()=>E,patchFetch:()=>q,requestAsyncStorage:()=>h,routeModule:()=>d,serverHooks:()=>g,staticGenerationAsyncStorage:()=>m,staticGenerationBailout:()=>x});var a={};t.r(a),t.d(a,{POST:()=>c,runtime:()=>l});var n=t(5419),i=t(9108),s=t(9678),o=t(8070),u=t(5683),p=t(5752);let l="nodejs";async function c(e){(0,p.V1)(["OPENAI_API_KEY","SUPABASE_URL","SUPABASE_SERVICE_KEY"]);let{query:r,limit:t=5}=await e.json();if(!r)return o.Z.json({error:"query required"},{status:400});let a=await (0,u.D)(r,t);return o.Z.json({results:a})}let d=new n.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/rag-search/route",pathname:"/api/rag-search",filename:"route",bundlePath:"app/api/rag-search/route"},resolvedPagePath:"/Users/harrisonwang/ovafinal/app/api/rag-search/route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:h,staticGenerationAsyncStorage:m,serverHooks:g,headerHooks:f,staticGenerationBailout:x}=d,E="/api/rag-search/route";function q(){return(0,s.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:m})}},7399:(e,r,t)=>{t.d(r,{OC:()=>i,UI:()=>s});let a=new(t(6168)).ZP({apiKey:process.env.OPENAI_API_KEY}),n="text-embedding-3-small";async function i(e){let r=e.replace(/\n/g," ");return(await a.embeddings.create({model:n,input:r})).data[0].embedding}async function s(e){return(await a.embeddings.create({model:n,input:e.map(e=>e.replace(/\n/g," "))})).data.map(e=>e.embedding)}},5683:(e,r,t)=>{t.d(r,{D:()=>s,k:()=>i});var a=t(7399),n=t(8234);function i(e,r=800,t=80){let a=e.split(/\s+/),n=[],i=0;for(;i<a.length;){let e=a.slice(i,i+r).join(" ");n.push(e),i+=r-t}return n}async function s(e,r=5){let t=(0,n.b)(),i=await (0,a.OC)(e),{data:s,error:o}=await t.rpc("match_rules",{query_embedding:i,match_count:r});if(o)throw o;return s||[]}},8234:(e,r,t)=>{t.d(r,{b:()=>s});var a=t(7493);let n="https://uglzhvquiarxyahsnesj.supabase.co",i=process.env.SUPABASE_SERVICE_KEY,s=()=>{if(!n||!i)throw Error("Supabase environment variables missing (SUPABASE_URL, SUPABASE_SERVICE_KEY).");return(0,a.eI)(n,i,{global:{headers:{"x-client-info":"volleyball-ref-training"}},auth:{autoRefreshToken:!1,detectSessionInUrl:!1,persistSession:!1}})}},5752:(e,r,t)=>{function a(e){switch(e){case"easy":return 3;case"medium":return 4;case"hard":return 5;default:return 6}}function n(e){return e.map((e,r)=>`Rule Snippet ${r+1}${e.similarity?` (sim ${e.similarity.toFixed(2)})`:""}:
${e.chunk}`).join("\n\n")}function i(e){let r=e.filter(e=>!process.env[e]);if(r.length)throw Error(`Missing environment variables: ${r.join(", ")}`)}t.d(r,{V1:()=>i,aZ:()=>n,uF:()=>a})}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[638,164,168],()=>t(4045));module.exports=a})();